{"version":3,"sources":["../src/index.ts","../src/config.ts","../src/sdk-client.ts","../src/tools/check-job.ts","../src/helpers/format.ts","../src/tools/lookup-agent.ts","../src/tools/list-jobs.ts","../src/tools/check-balance.ts","../src/tools/get-template.ts","../src/tools/create-job.ts","../src/helpers/tx-encoder.ts","../src/tools/deliver-work.ts","../src/tools/settle-job.ts","../src/tools/open-dispute.ts","../src/tools/claim-refund.ts"],"sourcesContent":["import { McpServer } from \"@modelcontextprotocol/sdk/server/mcp.js\";\nimport { StdioServerTransport } from \"@modelcontextprotocol/sdk/server/stdio.js\";\nimport { z } from \"zod\";\nimport { loadConfig } from \"./config.js\";\nimport { createSdkClient, isSigningClient } from \"./sdk-client.js\";\n\n// Read tools\nimport { checkJobDef, handleCheckJob } from \"./tools/check-job.js\";\nimport { lookupAgentDef, handleLookupAgent } from \"./tools/lookup-agent.js\";\nimport { listJobsDef, handleListJobs } from \"./tools/list-jobs.js\";\nimport { checkBalanceDef, handleCheckBalance } from \"./tools/check-balance.js\";\nimport { getTemplateDef, handleGetTemplate } from \"./tools/get-template.js\";\n\n// Write tools\nimport { createJobDef, handleCreateJob } from \"./tools/create-job.js\";\nimport { deliverWorkDef, handleDeliverWork } from \"./tools/deliver-work.js\";\nimport { settleJobDef, handleSettleJob } from \"./tools/settle-job.js\";\nimport { openDisputeDef, handleOpenDispute } from \"./tools/open-dispute.js\";\nimport { claimRefundDef, handleClaimRefund } from \"./tools/claim-refund.js\";\n\n// ---------------------------------------------------------------------------\n// Bootstrap\n// ---------------------------------------------------------------------------\n\nconst config = loadConfig();\nconst client = createSdkClient(config);\nconst signing = isSigningClient(config);\n\nconst server = new McpServer({\n  name: \"aegis-protocol\",\n  version: \"0.1.0\",\n});\n\n// ---------------------------------------------------------------------------\n// Helper: wrap tool handlers with error handling and JSON serialization\n// ---------------------------------------------------------------------------\n\nfunction toolResult(data: unknown) {\n  return {\n    content: [\n      {\n        type: \"text\" as const,\n        text: JSON.stringify(data, null, 2),\n      },\n    ],\n  };\n}\n\nfunction toolError(error: unknown) {\n  const message = error instanceof Error ? error.message : String(error);\n  return {\n    content: [{ type: \"text\" as const, text: `Error: ${message}` }],\n    isError: true,\n  };\n}\n\n// ---------------------------------------------------------------------------\n// Read tools\n// ---------------------------------------------------------------------------\n\nserver.registerTool(checkJobDef.name, {\n  description: checkJobDef.description,\n  inputSchema: checkJobDef.inputSchema,\n}, async (args) => {\n  try {\n    return toolResult(await handleCheckJob(client, args));\n  } catch (e) {\n    return toolError(e);\n  }\n});\n\nserver.registerTool(lookupAgentDef.name, {\n  description: lookupAgentDef.description,\n  inputSchema: lookupAgentDef.inputSchema,\n}, async (args) => {\n  try {\n    return toolResult(await handleLookupAgent(client, args));\n  } catch (e) {\n    return toolError(e);\n  }\n});\n\nserver.registerTool(listJobsDef.name, {\n  description: listJobsDef.description,\n  inputSchema: listJobsDef.inputSchema,\n}, async (args) => {\n  try {\n    return toolResult(await handleListJobs(client, args));\n  } catch (e) {\n    return toolError(e);\n  }\n});\n\nserver.registerTool(checkBalanceDef.name, {\n  description: checkBalanceDef.description,\n  inputSchema: checkBalanceDef.inputSchema,\n}, async (args) => {\n  try {\n    return toolResult(await handleCheckBalance(client, args));\n  } catch (e) {\n    return toolError(e);\n  }\n});\n\nserver.registerTool(getTemplateDef.name, {\n  description: getTemplateDef.description,\n  inputSchema: getTemplateDef.inputSchema,\n}, async (args) => {\n  try {\n    return toolResult(await handleGetTemplate(client, args));\n  } catch (e) {\n    return toolError(e);\n  }\n});\n\n// ---------------------------------------------------------------------------\n// Write tools\n// ---------------------------------------------------------------------------\n\nserver.registerTool(createJobDef.name, {\n  description: createJobDef.description,\n  inputSchema: createJobDef.inputSchema,\n  annotations: {\n    title: \"Create Escrow Job\",\n    readOnlyHint: false,\n    destructiveHint: false,\n    openWorldHint: true,\n  },\n}, async (args) => {\n  try {\n    return toolResult(await handleCreateJob(client, config, args));\n  } catch (e) {\n    return toolError(e);\n  }\n});\n\nserver.registerTool(deliverWorkDef.name, {\n  description: deliverWorkDef.description,\n  inputSchema: deliverWorkDef.inputSchema,\n  annotations: {\n    title: \"Deliver Work\",\n    readOnlyHint: false,\n    destructiveHint: false,\n    openWorldHint: true,\n  },\n}, async (args) => {\n  try {\n    return toolResult(await handleDeliverWork(client, config, args));\n  } catch (e) {\n    return toolError(e);\n  }\n});\n\nserver.registerTool(settleJobDef.name, {\n  description: settleJobDef.description,\n  inputSchema: settleJobDef.inputSchema,\n  annotations: {\n    title: \"Settle Job\",\n    readOnlyHint: false,\n    destructiveHint: false,\n    openWorldHint: true,\n  },\n}, async (args) => {\n  try {\n    return toolResult(await handleSettleJob(client, config, args));\n  } catch (e) {\n    return toolError(e);\n  }\n});\n\nserver.registerTool(openDisputeDef.name, {\n  description: openDisputeDef.description,\n  inputSchema: openDisputeDef.inputSchema,\n  annotations: {\n    title: \"Open Dispute\",\n    readOnlyHint: false,\n    destructiveHint: false,\n    openWorldHint: true,\n  },\n}, async (args) => {\n  try {\n    return toolResult(await handleOpenDispute(client, config, args));\n  } catch (e) {\n    return toolError(e);\n  }\n});\n\nserver.registerTool(claimRefundDef.name, {\n  description: claimRefundDef.description,\n  inputSchema: claimRefundDef.inputSchema,\n  annotations: {\n    title: \"Claim Refund\",\n    readOnlyHint: false,\n    destructiveHint: false,\n    openWorldHint: true,\n  },\n}, async (args) => {\n  try {\n    return toolResult(await handleClaimRefund(client, config, args));\n  } catch (e) {\n    return toolError(e);\n  }\n});\n\n// ---------------------------------------------------------------------------\n// Connect transport and start\n// ---------------------------------------------------------------------------\n\nasync function main() {\n  const transport = new StdioServerTransport();\n  await server.connect(transport);\n\n  const mode = signing ? \"signing\" : \"read-only\";\n  console.error(`AEGIS MCP Server running (${mode} mode, chain: ${config.chain})`);\n}\n\nmain().catch((err) => {\n  console.error(\"Fatal:\", err);\n  process.exit(1);\n});\n","import { CHAIN_CONFIGS, type SupportedChain } from \"@aegis-protocol/types\";\n\nexport interface McpConfig {\n  chain: SupportedChain;\n  rpcUrl: string;\n  privateKey: string | undefined;\n  apiUrl: string | undefined;\n}\n\nexport function loadConfig(): McpConfig {\n  const chain = (process.env.AEGIS_CHAIN ?? \"base-sepolia\") as SupportedChain;\n\n  if (!CHAIN_CONFIGS[chain]) {\n    throw new Error(\n      `Unsupported chain: ${chain}. Valid: ${Object.keys(CHAIN_CONFIGS).join(\", \")}`,\n    );\n  }\n\n  const rpcUrl =\n    process.env.AEGIS_RPC_URL ?? CHAIN_CONFIGS[chain].rpcUrl;\n\n  return {\n    chain,\n    rpcUrl,\n    privateKey: process.env.AEGIS_PRIVATE_KEY,\n    apiUrl: process.env.AEGIS_API_URL,\n  };\n}\n","import { createPublicClient, createWalletClient, http } from \"viem\";\nimport { privateKeyToAccount } from \"viem/accounts\";\nimport { baseSepolia, base } from \"viem/chains\";\nimport { AegisClient } from \"@aegis-protocol/sdk\";\nimport type { McpConfig } from \"./config.js\";\n\nconst CHAIN_MAP = { \"base-sepolia\": baseSepolia, base } as const;\n\nexport function createSdkClient(config: McpConfig): AegisClient {\n  const viemChain = CHAIN_MAP[config.chain];\n\n  if (config.privateKey) {\n    const account = privateKeyToAccount(config.privateKey as `0x${string}`);\n    const publicClient = createPublicClient({\n      chain: viemChain,\n      transport: http(config.rpcUrl),\n    });\n    const walletClient = createWalletClient({\n      account,\n      chain: viemChain,\n      transport: http(config.rpcUrl),\n    });\n    // Cast needed: viem chain-specific PublicClient types diverge across packages\n    return AegisClient.fromViem({\n      walletClient,\n      publicClient: publicClient as any,\n      chain: config.chain,\n    });\n  }\n\n  return AegisClient.readOnly({\n    rpcUrl: config.rpcUrl,\n    chain: config.chain,\n  });\n}\n\nexport function isSigningClient(config: McpConfig): boolean {\n  return !!config.privateKey;\n}\n","import { z } from \"zod\";\nimport type { AegisClient } from \"@aegis-protocol/sdk\";\nimport type { Hex } from \"@aegis-protocol/types\";\nimport { formatJobForLLM } from \"../helpers/format.js\";\n\nexport const checkJobDef = {\n  name: \"aegis_check_job\",\n  description:\n    \"Check the current state of an escrow job — whether it's funded, delivered, in validation, settled, or disputed. Use this to monitor job progress before taking your next action.\",\n  inputSchema: {\n    jobId: z\n      .string()\n      .describe(\"The escrow job ID (0x-prefixed hex string)\"),\n  },\n};\n\nexport async function handleCheckJob(\n  client: AegisClient,\n  args: { jobId: string },\n) {\n  const job = await client.escrow.getJob(args.jobId as Hex);\n  return formatJobForLLM(args.jobId, job);\n}\n","import { JobState, DisputeResolution } from \"@aegis-protocol/types\";\nimport type { Job, Dispute, JobTemplate } from \"@aegis-protocol/types\";\nimport { formatUSDC } from \"@aegis-protocol/sdk\";\nimport type { ReputationSummary } from \"@aegis-protocol/sdk\";\n\nconst JOB_STATE_LABELS: Record<number, string> = {\n  [JobState.CREATED]: \"Created\",\n  [JobState.FUNDED]: \"Funded — waiting for provider to deliver\",\n  [JobState.DELIVERED]: \"Delivered — awaiting validation\",\n  [JobState.VALIDATING]: \"Validating on-chain\",\n  [JobState.DISPUTE_WINDOW]: \"Dispute window open (24h)\",\n  [JobState.SETTLED]: \"Settled — payment released\",\n  [JobState.DISPUTED]: \"Disputed — under resolution\",\n  [JobState.RESOLVED]: \"Dispute resolved\",\n  [JobState.EXPIRED]: \"Expired — deadline missed\",\n  [JobState.REFUNDED]: \"Refunded to client\",\n  [JobState.CANCELLED]: \"Cancelled\",\n};\n\nconst DISPUTE_METHOD_LABELS: Record<number, string> = {\n  [DisputeResolution.NONE]: \"None\",\n  [DisputeResolution.RE_VALIDATION]: \"Automated re-validation\",\n  [DisputeResolution.ARBITRATOR]: \"Arbitrator ruling\",\n  [DisputeResolution.TIMEOUT_DEFAULT]: \"Timeout default (50/50)\",\n  [DisputeResolution.CLIENT_CONFIRM]: \"Client confirmed\",\n};\n\nexport function formatTimestamp(ts: bigint): string {\n  if (ts === 0n) return \"N/A\";\n  return new Date(Number(ts) * 1000).toISOString();\n}\n\nexport function formatJobForLLM(jobId: string, job: Job) {\n  return {\n    jobId,\n    state: JOB_STATE_LABELS[job.state] ?? `Unknown (${job.state})`,\n    stateCode: job.state,\n    clientAgentId: job.clientAgentId.toString(),\n    providerAgentId: job.providerAgentId.toString(),\n    clientAddress: job.clientAddress,\n    providerWallet: job.providerWallet,\n    amount: `${formatUSDC(job.amount)} USDC`,\n    protocolFee: `${Number(job.protocolFeeBps) / 100}%`,\n    validationScore: job.validationScore,\n    validationThreshold: job.validationThreshold,\n    jobSpecURI: job.jobSpecURI,\n    deliverableURI: job.deliverableURI || \"Not yet delivered\",\n    deadline: formatTimestamp(job.deadline),\n    createdAt: formatTimestamp(job.createdAt),\n    deliveredAt: formatTimestamp(job.deliveredAt),\n    settledAt: formatTimestamp(job.settledAt),\n    disputeWindowEnd: formatTimestamp(job.disputeWindowEnd),\n    resolution:\n      DISPUTE_METHOD_LABELS[job.resolution] ?? `Unknown (${job.resolution})`,\n  };\n}\n\nexport function formatDisputeForLLM(disputeId: string, dispute: Dispute) {\n  return {\n    disputeId,\n    jobId: dispute.jobId,\n    initiator: dispute.initiator,\n    respondent: dispute.respondent,\n    resolved: dispute.resolved,\n    method:\n      DISPUTE_METHOD_LABELS[dispute.method] ?? `Unknown (${dispute.method})`,\n    ruling: dispute.ruling,\n    initiatorEvidenceURI: dispute.initiatorEvidenceURI,\n    respondentEvidenceURI: dispute.respondentEvidenceURI || \"Not submitted\",\n    respondentSubmitted: dispute.respondentSubmitted,\n    arbitrator: dispute.arbitrator,\n    createdAt: formatTimestamp(dispute.createdAt),\n    evidenceDeadline: formatTimestamp(dispute.evidenceDeadline),\n    resolutionDeadline: formatTimestamp(dispute.resolutionDeadline),\n    initiatorBond: `${formatUSDC(dispute.initiatorBond)} USDC`,\n  };\n}\n\nexport function formatTemplateForLLM(\n  templateId: string,\n  template: JobTemplate,\n) {\n  return {\n    templateId,\n    name: template.name,\n    active: template.active,\n    creator: template.creator,\n    defaultValidator: template.defaultValidator,\n    defaultTimeout: `${Number(template.defaultTimeout) / 3600} hours`,\n    fee: `${Number(template.feeBps) / 100}%`,\n    minValidationScore: template.minValidation,\n    defaultDisputeSplit: template.defaultDisputeSplit,\n  };\n}\n\nexport function formatReputationForLLM(\n  agentId: string,\n  summary: ReputationSummary,\n) {\n  const score =\n    summary.count > 0n\n      ? Number(summary.summaryValue) /\n        10 ** summary.summaryValueDecimals\n      : 0;\n\n  return {\n    agentId,\n    feedbackCount: summary.count.toString(),\n    averageScore: score.toFixed(2),\n    hasReputation: summary.count > 0n,\n  };\n}\n","import { z } from \"zod\";\nimport type { AegisClient } from \"@aegis-protocol/sdk\";\nimport { formatReputationForLLM } from \"../helpers/format.js\";\n\nexport const lookupAgentDef = {\n  name: \"aegis_lookup_agent\",\n  description:\n    \"Look up an AI agent's on-chain identity and reputation before creating a job with them. Returns their wallet address, owner, and reputation score from the ERC-8004 registry. Always check reputation before committing funds to a new provider.\",\n  inputSchema: {\n    agentId: z\n      .string()\n      .describe(\"The ERC-8004 agent ID (numeric string, e.g. '1')\"),\n  },\n};\n\nexport async function handleLookupAgent(\n  client: AegisClient,\n  args: { agentId: string },\n) {\n  const id = BigInt(args.agentId);\n\n  // Parallel reads for identity + reputation\n  const [wallet, owner, clients] = await Promise.all([\n    client.identity.getAgentWallet(id),\n    client.identity.ownerOf(id),\n    client.reputation.getClients(id),\n  ]);\n\n  // Get reputation summary using the client list (required for Sybil prevention)\n  const summary = await client.reputation.getSummary(id, clients);\n  const reputation = formatReputationForLLM(args.agentId, summary);\n\n  return {\n    agentId: args.agentId,\n    wallet,\n    owner,\n    exists: true,\n    feedbackCount: reputation.feedbackCount,\n    averageScore: reputation.averageScore,\n    hasReputation: reputation.hasReputation,\n  };\n}\n","import { z } from \"zod\";\nimport type { AegisClient } from \"@aegis-protocol/sdk\";\nimport { formatJobForLLM } from \"../helpers/format.js\";\n\nexport const listJobsDef = {\n  name: \"aegis_list_jobs\",\n  description:\n    \"List all escrow jobs for a specific agent. Use this to review an agent's job history or check your own active jobs.\",\n  inputSchema: {\n    agentId: z\n      .string()\n      .describe(\"The ERC-8004 agent ID (numeric string, e.g. '1')\"),\n  },\n};\n\nexport async function handleListJobs(\n  client: AegisClient,\n  args: { agentId: string },\n) {\n  const id = BigInt(args.agentId);\n  const jobIds = await client.escrow.getAgentJobs(id);\n\n  if (jobIds.length === 0) {\n    return { agentId: args.agentId, jobs: [], message: \"No jobs found for this agent.\" };\n  }\n\n  // Fetch all jobs in parallel\n  const jobs = await Promise.all(\n    jobIds.map(async (jobId) => {\n      const job = await client.escrow.getJob(jobId);\n      return formatJobForLLM(jobId, job);\n    }),\n  );\n\n  return { agentId: args.agentId, totalJobs: jobs.length, jobs };\n}\n","import { z } from \"zod\";\nimport type { AegisClient } from \"@aegis-protocol/sdk\";\nimport { formatUSDC } from \"@aegis-protocol/sdk\";\nimport type { Hex } from \"@aegis-protocol/types\";\n\nexport const checkBalanceDef = {\n  name: \"aegis_check_balance\",\n  description:\n    \"Check an address's USDC balance and current escrow approval amount. Use this before creating a job to verify the client has sufficient funds and has approved the escrow contract.\",\n  inputSchema: {\n    address: z\n      .string()\n      .describe(\"Ethereum address to check (0x-prefixed)\"),\n  },\n};\n\nexport async function handleCheckBalance(\n  client: AegisClient,\n  args: { address: string },\n) {\n  const address = args.address as Hex;\n  const escrowAddress = \"0xe988128467299fD856Bb45D2241811837BF35E77\" as Hex;\n\n  const [balance, allowance] = await Promise.all([\n    client.usdc.balanceOf(address),\n    client.usdc.allowance(address, escrowAddress),\n  ]);\n\n  return {\n    address: args.address,\n    usdcBalance: `${formatUSDC(balance)} USDC`,\n    usdcBalanceRaw: balance.toString(),\n    escrowAllowance: `${formatUSDC(allowance)} USDC`,\n    escrowAllowanceRaw: allowance.toString(),\n    canCreateJob: balance > 0n && allowance > 0n,\n  };\n}\n","import { z } from \"zod\";\nimport type { AegisClient } from \"@aegis-protocol/sdk\";\nimport { formatTemplateForLLM } from \"../helpers/format.js\";\n\nexport const getTemplateDef = {\n  name: \"aegis_get_template\",\n  description:\n    \"Get the default parameters for a job template. Templates provide pre-configured validator, timeout, and validation threshold for common job types like code-review or data-analysis. Use a template to create jobs faster with standardized terms.\",\n  inputSchema: {\n    templateId: z\n      .string()\n      .describe(\"Template ID (numeric string, e.g. '1')\"),\n  },\n};\n\nexport async function handleGetTemplate(\n  client: AegisClient,\n  args: { templateId: string },\n) {\n  const id = BigInt(args.templateId);\n  const template = await client.factory.getTemplate(id);\n  return formatTemplateForLLM(args.templateId, template);\n}\n","import { z } from \"zod\";\nimport type { AegisClient } from \"@aegis-protocol/sdk\";\nimport { parseUSDC, formatUSDC } from \"@aegis-protocol/sdk\";\nimport type { Hex, ContractAddresses } from \"@aegis-protocol/types\";\nimport { CHAIN_CONFIGS } from \"@aegis-protocol/types\";\nimport { encodeCreateJobTx } from \"../helpers/tx-encoder.js\";\nimport type { McpConfig } from \"../config.js\";\n\nexport const createJobDef = {\n  name: \"aegis_create_job\",\n  description:\n    \"Create a trustless escrow job when you need to pay another AI agent for work but want to ensure quality before releasing payment. The USDC payment is locked in a smart contract and only released when the work passes on-chain validation. Use this instead of direct payment whenever the task value exceeds $5 or when you haven't worked with the provider agent before.\",\n  inputSchema: {\n    clientAgentId: z\n      .string()\n      .describe(\"Your ERC-8004 agent ID (numeric string)\"),\n    providerAgentId: z\n      .string()\n      .describe(\"The provider agent's ERC-8004 ID (numeric string)\"),\n    amount: z\n      .string()\n      .describe('USDC amount to escrow (e.g. \"50.00\")'),\n    jobSpecURI: z\n      .string()\n      .describe(\"URL to the job specification document\"),\n    jobSpecHash: z\n      .string()\n      .describe(\"Keccak256 hash of the job spec (0x-prefixed)\"),\n    validatorAddress: z\n      .string()\n      .describe(\"Address of the on-chain validator contract (0x-prefixed)\"),\n    deadlineSeconds: z\n      .number()\n      .describe(\"Seconds from now until deadline (e.g. 86400 for 24 hours)\"),\n    validationThreshold: z\n      .number()\n      .optional()\n      .describe(\"Minimum validation score 0-100 to pass (default: 70)\"),\n  },\n};\n\nexport async function handleCreateJob(\n  client: AegisClient,\n  config: McpConfig,\n  args: {\n    clientAgentId: string;\n    providerAgentId: string;\n    amount: string;\n    jobSpecURI: string;\n    jobSpecHash: string;\n    validatorAddress: string;\n    deadlineSeconds: number;\n    validationThreshold?: number;\n  },\n) {\n  const amount = parseUSDC(args.amount);\n  const deadline = BigInt(Math.floor(Date.now() / 1000) + args.deadlineSeconds);\n  const threshold = args.validationThreshold ?? 70;\n\n  const params = {\n    clientAgentId: BigInt(args.clientAgentId),\n    providerAgentId: BigInt(args.providerAgentId),\n    jobSpecHash: args.jobSpecHash as Hex,\n    jobSpecURI: args.jobSpecURI,\n    validatorAddress: args.validatorAddress as Hex,\n    deadline,\n    amount,\n    validationThreshold: threshold,\n  };\n\n  // If we have a signer, execute the transaction directly\n  if (config.privateKey) {\n    const txHash = await client.escrow.createJob(params);\n    return {\n      success: true,\n      txHash,\n      amount: `${formatUSDC(amount)} USDC`,\n      deadline: new Date(Number(deadline) * 1000).toISOString(),\n      validationThreshold: threshold,\n      message: \"Job created and USDC locked in escrow. Transaction submitted.\",\n    };\n  }\n\n  // Read-only mode: return unsigned tx for agent to sign\n  const chainConfig = CHAIN_CONFIGS[config.chain];\n  const unsignedTx = encodeCreateJobTx(\n    chainConfig.contracts,\n    chainConfig.chainId,\n    params,\n  );\n\n  return {\n    success: false,\n    mode: \"unsigned\",\n    unsignedTx,\n    amount: `${formatUSDC(amount)} USDC`,\n    deadline: new Date(Number(deadline) * 1000).toISOString(),\n    validationThreshold: threshold,\n    message:\n      \"Sign the unsigned transaction and submit it to the AEGIS API relay at POST /tx/relay with { signedTx: '0x...' }.\",\n    note: \"You must also approve the escrow contract to spend your USDC before this transaction will succeed. Call USDC.approve(escrowAddress, amount) first.\",\n  };\n}\n","import { encodeFunctionData } from \"viem\";\nimport {\n  aegisEscrowAbi,\n  aegisDisputeAbi,\n} from \"@aegis-protocol/abis\";\nimport type { Hex, ContractAddresses } from \"@aegis-protocol/types\";\n\nexport interface UnsignedTx {\n  to: Hex;\n  data: Hex;\n  value: string;\n  chainId: number;\n  description: string;\n}\n\nexport function encodeCreateJobTx(\n  addresses: ContractAddresses,\n  chainId: number,\n  args: {\n    clientAgentId: bigint;\n    providerAgentId: bigint;\n    jobSpecHash: Hex;\n    jobSpecURI: string;\n    validatorAddress: Hex;\n    deadline: bigint;\n    amount: bigint;\n    validationThreshold: number;\n  },\n): UnsignedTx {\n  return {\n    to: addresses.escrow,\n    data: encodeFunctionData({\n      abi: aegisEscrowAbi,\n      functionName: \"createJob\",\n      args: [\n        args.clientAgentId,\n        args.providerAgentId,\n        args.jobSpecHash,\n        args.jobSpecURI,\n        args.validatorAddress,\n        args.deadline,\n        args.amount,\n        args.validationThreshold,\n      ],\n    }),\n    value: \"0\",\n    chainId,\n    description: `Create escrow job: ${args.clientAgentId} → ${args.providerAgentId}`,\n  };\n}\n\nexport function encodeDeliverWorkTx(\n  addresses: ContractAddresses,\n  chainId: number,\n  args: { jobId: Hex; deliverableURI: string; deliverableHash: Hex },\n): UnsignedTx {\n  return {\n    to: addresses.escrow,\n    data: encodeFunctionData({\n      abi: aegisEscrowAbi,\n      functionName: \"submitDeliverable\",\n      args: [args.jobId, args.deliverableURI, args.deliverableHash],\n    }),\n    value: \"0\",\n    chainId,\n    description: `Submit deliverable for job ${args.jobId}`,\n  };\n}\n\nexport function encodeConfirmDeliveryTx(\n  addresses: ContractAddresses,\n  chainId: number,\n  jobId: Hex,\n): UnsignedTx {\n  return {\n    to: addresses.escrow,\n    data: encodeFunctionData({\n      abi: aegisEscrowAbi,\n      functionName: \"confirmDelivery\",\n      args: [jobId],\n    }),\n    value: \"0\",\n    chainId,\n    description: `Confirm delivery for job ${jobId}`,\n  };\n}\n\nexport function encodeSettleAfterWindowTx(\n  addresses: ContractAddresses,\n  chainId: number,\n  jobId: Hex,\n): UnsignedTx {\n  return {\n    to: addresses.escrow,\n    data: encodeFunctionData({\n      abi: aegisEscrowAbi,\n      functionName: \"settleAfterDisputeWindow\",\n      args: [jobId],\n    }),\n    value: \"0\",\n    chainId,\n    description: `Settle job ${jobId} after dispute window`,\n  };\n}\n\nexport function encodeRaiseDisputeTx(\n  addresses: ContractAddresses,\n  chainId: number,\n  args: { jobId: Hex; evidenceURI: string; evidenceHash: Hex },\n): UnsignedTx {\n  return {\n    to: addresses.escrow,\n    data: encodeFunctionData({\n      abi: aegisEscrowAbi,\n      functionName: \"raiseDispute\",\n      args: [args.jobId, args.evidenceURI, args.evidenceHash],\n    }),\n    value: \"0\",\n    chainId,\n    description: `Raise dispute on job ${args.jobId}`,\n  };\n}\n\nexport function encodeClaimTimeoutTx(\n  addresses: ContractAddresses,\n  chainId: number,\n  jobId: Hex,\n): UnsignedTx {\n  return {\n    to: addresses.escrow,\n    data: encodeFunctionData({\n      abi: aegisEscrowAbi,\n      functionName: \"claimTimeout\",\n      args: [jobId],\n    }),\n    value: \"0\",\n    chainId,\n    description: `Claim timeout refund for job ${jobId}`,\n  };\n}\n","import { z } from \"zod\";\nimport type { AegisClient } from \"@aegis-protocol/sdk\";\nimport type { Hex } from \"@aegis-protocol/types\";\nimport { CHAIN_CONFIGS } from \"@aegis-protocol/types\";\nimport { encodeDeliverWorkTx } from \"../helpers/tx-encoder.js\";\nimport type { McpConfig } from \"../config.js\";\n\nexport const deliverWorkDef = {\n  name: \"aegis_deliver_work\",\n  description:\n    \"Submit completed work for a job you're the provider on. The deliverable is sent to the on-chain validator for quality assessment. If the validation score meets the job's threshold, payment is released automatically. If it falls short, a dispute window opens where the client can challenge.\",\n  inputSchema: {\n    jobId: z\n      .string()\n      .describe(\"The escrow job ID (0x-prefixed hex string)\"),\n    deliverableURI: z\n      .string()\n      .describe(\"URL to the completed deliverable (e.g. IPFS link)\"),\n    deliverableHash: z\n      .string()\n      .describe(\"Keccak256 hash of the deliverable (0x-prefixed)\"),\n  },\n};\n\nexport async function handleDeliverWork(\n  client: AegisClient,\n  config: McpConfig,\n  args: { jobId: string; deliverableURI: string; deliverableHash: string },\n) {\n  if (config.privateKey) {\n    const txHash = await client.escrow.submitDeliverable(args.jobId as Hex, {\n      deliverableURI: args.deliverableURI,\n      deliverableHash: args.deliverableHash as Hex,\n    });\n    return {\n      success: true,\n      txHash,\n      jobId: args.jobId,\n      message:\n        \"Deliverable submitted. On-chain validation has been triggered. Use aegis_check_job to monitor progress.\",\n    };\n  }\n\n  const chainConfig = CHAIN_CONFIGS[config.chain];\n  const unsignedTx = encodeDeliverWorkTx(chainConfig.contracts, chainConfig.chainId, {\n    jobId: args.jobId as Hex,\n    deliverableURI: args.deliverableURI,\n    deliverableHash: args.deliverableHash as Hex,\n  });\n\n  return {\n    success: false,\n    mode: \"unsigned\",\n    unsignedTx,\n    jobId: args.jobId,\n    message:\n      \"Sign this transaction and submit to POST /tx/relay to deliver the work.\",\n  };\n}\n","import { z } from \"zod\";\nimport type { AegisClient } from \"@aegis-protocol/sdk\";\nimport type { Hex } from \"@aegis-protocol/types\";\nimport { CHAIN_CONFIGS } from \"@aegis-protocol/types\";\nimport {\n  encodeConfirmDeliveryTx,\n  encodeSettleAfterWindowTx,\n} from \"../helpers/tx-encoder.js\";\nimport type { McpConfig } from \"../config.js\";\n\nexport const settleJobDef = {\n  name: \"aegis_settle_job\",\n  description:\n    'Settle a completed job to release payment to the provider. Use action \"confirm\" as the client to confirm delivery early (skips dispute window). Use action \"settle_after_window\" after the 24-hour dispute window has closed without a dispute being raised.',\n  inputSchema: {\n    jobId: z\n      .string()\n      .describe(\"The escrow job ID (0x-prefixed hex string)\"),\n    action: z\n      .enum([\"confirm\", \"settle_after_window\"])\n      .describe(\n        '\"confirm\" = client confirms delivery early, \"settle_after_window\" = settle after dispute window closes',\n      ),\n  },\n};\n\nexport async function handleSettleJob(\n  client: AegisClient,\n  config: McpConfig,\n  args: { jobId: string; action: \"confirm\" | \"settle_after_window\" },\n) {\n  const jobId = args.jobId as Hex;\n\n  if (config.privateKey) {\n    const txHash =\n      args.action === \"confirm\"\n        ? await client.escrow.confirmDelivery(jobId)\n        : await client.escrow.settleAfterDisputeWindow(jobId);\n\n    return {\n      success: true,\n      txHash,\n      jobId: args.jobId,\n      action: args.action,\n      message: \"Job settled. Payment has been released to the provider.\",\n    };\n  }\n\n  const chainConfig = CHAIN_CONFIGS[config.chain];\n  const unsignedTx =\n    args.action === \"confirm\"\n      ? encodeConfirmDeliveryTx(chainConfig.contracts, chainConfig.chainId, jobId)\n      : encodeSettleAfterWindowTx(chainConfig.contracts, chainConfig.chainId, jobId);\n\n  return {\n    success: false,\n    mode: \"unsigned\",\n    unsignedTx,\n    jobId: args.jobId,\n    action: args.action,\n    message: \"Sign this transaction and submit to POST /tx/relay to settle the job.\",\n  };\n}\n","import { z } from \"zod\";\nimport type { AegisClient } from \"@aegis-protocol/sdk\";\nimport type { Hex } from \"@aegis-protocol/types\";\nimport { CHAIN_CONFIGS } from \"@aegis-protocol/types\";\nimport { encodeRaiseDisputeTx } from \"../helpers/tx-encoder.js\";\nimport type { McpConfig } from \"../config.js\";\n\nexport const openDisputeDef = {\n  name: \"aegis_open_dispute\",\n  description:\n    \"Open a dispute when the delivered work doesn't meet the job requirements. This must be done during the dispute window (24 hours after validation). A 10 USDC dispute bond is required. The dispute goes through 3-tier resolution: (1) automated re-validation by a different validator, (2) staked human arbitrator ruling, (3) timeout default (50/50 split).\",\n  inputSchema: {\n    jobId: z\n      .string()\n      .describe(\"The escrow job ID (0x-prefixed hex string)\"),\n    evidenceURI: z\n      .string()\n      .describe(\"URL to evidence supporting the dispute claim\"),\n    evidenceHash: z\n      .string()\n      .describe(\"Keccak256 hash of the evidence (0x-prefixed)\"),\n  },\n};\n\nexport async function handleOpenDispute(\n  client: AegisClient,\n  config: McpConfig,\n  args: { jobId: string; evidenceURI: string; evidenceHash: string },\n) {\n  if (config.privateKey) {\n    const txHash = await client.escrow.raiseDispute(\n      args.jobId as Hex,\n      args.evidenceURI,\n      args.evidenceHash as Hex,\n    );\n    return {\n      success: true,\n      txHash,\n      jobId: args.jobId,\n      message:\n        \"Dispute initiated. 10 USDC bond locked. The dispute will go through 3-tier resolution. Use aegis_check_job to monitor progress.\",\n    };\n  }\n\n  const chainConfig = CHAIN_CONFIGS[config.chain];\n  const unsignedTx = encodeRaiseDisputeTx(\n    chainConfig.contracts,\n    chainConfig.chainId,\n    {\n      jobId: args.jobId as Hex,\n      evidenceURI: args.evidenceURI,\n      evidenceHash: args.evidenceHash as Hex,\n    },\n  );\n\n  return {\n    success: false,\n    mode: \"unsigned\",\n    unsignedTx,\n    jobId: args.jobId,\n    message:\n      \"Sign this transaction and submit to POST /tx/relay to open the dispute. Requires 10 USDC dispute bond (approve dispute contract first).\",\n  };\n}\n","import { z } from \"zod\";\nimport type { AegisClient } from \"@aegis-protocol/sdk\";\nimport type { Hex } from \"@aegis-protocol/types\";\nimport { CHAIN_CONFIGS } from \"@aegis-protocol/types\";\nimport { encodeClaimTimeoutTx } from \"../helpers/tx-encoder.js\";\nimport type { McpConfig } from \"../config.js\";\n\nexport const claimRefundDef = {\n  name: \"aegis_claim_refund\",\n  description:\n    \"Claim a refund on an escrow job where the provider missed the deadline without delivering work. The full USDC amount is returned to the client. Only callable after the job deadline has passed.\",\n  inputSchema: {\n    jobId: z\n      .string()\n      .describe(\"The escrow job ID (0x-prefixed hex string)\"),\n  },\n};\n\nexport async function handleClaimRefund(\n  client: AegisClient,\n  config: McpConfig,\n  args: { jobId: string },\n) {\n  if (config.privateKey) {\n    const txHash = await client.escrow.claimTimeout(args.jobId as Hex);\n    return {\n      success: true,\n      txHash,\n      jobId: args.jobId,\n      message: \"Refund claimed. The full USDC amount has been returned to the client.\",\n    };\n  }\n\n  const chainConfig = CHAIN_CONFIGS[config.chain];\n  const unsignedTx = encodeClaimTimeoutTx(\n    chainConfig.contracts,\n    chainConfig.chainId,\n    args.jobId as Hex,\n  );\n\n  return {\n    success: false,\n    mode: \"unsigned\",\n    unsignedTx,\n    jobId: args.jobId,\n    message: \"Sign this transaction and submit to POST /tx/relay to claim the refund.\",\n  };\n}\n"],"mappings":"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","names":["config","client","z","z","client","z","z","client","z","formatUSDC","client","z","z","client","z","formatUSDC","CHAIN_CONFIGS","z","client","config","formatUSDC","CHAIN_CONFIGS","z","CHAIN_CONFIGS","z","client","config","CHAIN_CONFIGS","z","CHAIN_CONFIGS","z","client","config","CHAIN_CONFIGS","z","CHAIN_CONFIGS","z","client","config","CHAIN_CONFIGS","z","CHAIN_CONFIGS","z","client","config","CHAIN_CONFIGS"]}